{"ast":null,"code":"var _jsxFileName = \"/Users/hipheckt/codes/evestng/react/src/Videos.js\";\nimport React, { Component } from 'react';\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\"; // import Sound from 'react-sound';\n\nimport swal from 'sweetalert';\nimport $ from \"jquery\";\nimport Header from './common/Header';\nimport Pen from \"./assets/images/icons/gallery.png\";\nimport Pen2 from \"./assets/images/icons/video.png\";\n\nvar _name, _tags;\n\nexport default class Galleri extends Component {\n  constructor(props) {\n    super(props); // let { user } = this.props.appstate;\n\n    this.queryField = e => {\n      e.preventDefault();\n      this.setState({\n        query: e.target.value\n      });\n      axios.get(`${axios.defaults.baseURL}/photos/${this.state.query}`).then(response => {\n        console.log(response);\n        return response;\n      }).then(json => {\n        if (json.data.success) {\n          this.setState({\n            tributes: json.data.tributes\n          });\n        } else alert(\"Fetching Photos Failed!\");\n      }).catch(error => {\n        console.error(`An Error Occured! ${error}`);\n      });\n    };\n\n    this.fetchTributes = e => {\n      axios.get(`${axios.defaults.baseURL}/videos`).then(response => {\n        console.log(response);\n        return response;\n      }).then(json => {\n        if (json.data.success) {\n          this.setState({\n            tributes: json.data.tributes\n          });\n        } else alert(\"Fetching Tributes Failed!\");\n      }).catch(error => {\n        console.error(`An Error Occured! ${error}`);\n      });\n    };\n\n    this.handleTributePost = e => {\n      e.preventDefault();\n      $(\"#upload-button\").attr(\"disabled\", \"disabled\").html(\"Uploading Video...\");\n      var formData = new FormData();\n      formData.append(\"name\", _name.value);\n      formData.append(\"video\", this.state.file);\n      formData.append(\"tags\", _tags.value);\n      console.log(formData);\n      axios({\n        method: 'post',\n        url: `${axios.defaults.baseURL}/video`,\n        data: formData,\n        headers: {\n          'Content-Type': 'multipart/form-data'\n        }\n      }).then(response => {\n        console.log(response);\n        return response;\n      }).then(json => {\n        const {\n          id,\n          name,\n          video,\n          tags\n        } = json.data.tribute;\n        let tributeData = {\n          id,\n          name,\n          video,\n          tags,\n          timestamp: new Date().toString()\n        };\n        let appState = {\n          tribute: tributeData\n        }; // save app state with user date in local storage\n\n        localStorage[\"appState\"] = JSON.stringify(appState);\n        this.setState({\n          tribute: appState.tribute\n        });\n\n        if (json.data.success === true) {\n          swal(\"Published!\", \"\" + json.data.message, \"success\", {\n            button: false,\n            timer: 1500\n          });\n          $(\"#name-input\").val('');\n          $(\"#video-input\").val('');\n          $(\"#tag-input\").val('');\n          this.fetchTributes(); // redirect home\n          // this.props.history.push(\"/dashboard\");\n        } else {\n          // alert(json.data.message);\n          swal(\"Alert!\", \"\" + json.data.message, \"warning\", {\n            button: false,\n            timer: 1500\n          });\n          $(\"#upload-button\").removeAttr(\"disabled\").html(\"Upload Video(Max. 10MB)\");\n        }\n      }).catch(error => {\n        // alert(\"An Error Occured!\" + error);\n        console.log(error.response.data);\n        swal(\"Warning!\", \"Select Video to Upload\", \"warning\", {\n          button: false,\n          timer: 1500\n        });\n        $(\"#upload-button\").removeAttr(\"disabled\").html(\"Upload Video(Max. 10MB)\");\n      });\n    };\n\n    this.uploadVideo = e => {\n      this.photoUpload.click();\n    };\n\n    this.onChange = event => {\n      this.setState({\n        imageSource: '',\n        imageData: '',\n        file: event.target.files[0]\n      });\n      const file = event.target.files[0];\n      console.log(file);\n\n      if (file) {\n        let reader = new FileReader();\n        reader.readAsDataURL(event.target.files[0]);\n\n        reader.onload = event => {\n          this.setState({\n            imageSource: event.target.result,\n            imageData: file\n          });\n        };\n      }\n    };\n\n    this.state = {\n      file: null,\n      tributes: [],\n      currentPage: 1,\n      tributesPerPage: 50,\n      query: \"\"\n    };\n    this.onChange = this.onChange.bind(this);\n  }\n\n  componentDidMount() {\n    this.fetchTributes();\n  }\n\n  render() {\n    const {\n      currentPage,\n      tributesPerPage\n    } = this.state;\n    const tributesList = this.state.tributes;\n    const indexOfLastTribute = currentPage * tributesPerPage;\n    const indexOfFirstTribute = indexOfLastTribute - tributesPerPage;\n    const currentTributes = tributesList.slice(indexOfFirstTribute, indexOfLastTribute);\n    const renderTributes = currentTributes.map((tribute, index) => {\n      return /*#__PURE__*/React.createElement(\"div\", {\n        className: \"gallery-videos\",\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 181,\n          columnNumber: 17\n        }\n      }, /*#__PURE__*/React.createElement(\"video\", {\n        src: tribute.video,\n        controls: true,\n        __self: this,\n        __source: {\n          fileName: _jsxFileName,\n          lineNumber: 182,\n          columnNumber: 21\n        }\n      }));\n    }); // const { currentPage, tributesPerPage } = this.state;\n    // Logic for displaying tributes\n    // const tributesList = this.state.tributes;\n    // const indexOfLastTribute = currentPage * tributesPerPage;\n    // const indexOfFirstTribute = indexOfLastTribute - tributesPerPage;\n    // const currentTributes = tributesList.slice(indexOfFirstTribute, indexOfLastTribute);\n    // const renderTributes = currentTributes.map((tribute, index) => {\n    // return (\n    //         <img src={tribute.photo} key={tribute.id} className=\"gallery-image\" alt=\"\"/>\n    // );\n    // });\n\n    return /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 201,\n        columnNumber: 13\n      }\n    }, /*#__PURE__*/React.createElement(Header, {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 202,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"center-canvas\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 203,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"gallery-menu\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 204,\n        columnNumber: 47\n      }\n    }), /*#__PURE__*/React.createElement(Link, {\n      to: \"gallery\",\n      className: \"gallery-menu-item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 70\n      }\n    }, \"Photos \", /*#__PURE__*/React.createElement(\"img\", {\n      src: Pen,\n      className: \"pen\",\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 205,\n        columnNumber: 81\n      }\n    }))), /*#__PURE__*/React.createElement(Link, {\n      to: \"videos\",\n      className: \"gallery-menu-item\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 21\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 69\n      }\n    }, \"Videos \", /*#__PURE__*/React.createElement(\"img\", {\n      src: Pen2,\n      className: \"pen\",\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 206,\n        columnNumber: 80\n      }\n    })))), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"query-field\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 208,\n        columnNumber: 17\n      }\n    }, \"Filter: \", /*#__PURE__*/React.createElement(\"input\", {\n      name: \"query\",\n      className: \"query-input\",\n      placeholder: \" search videos by name or tags...\",\n      onChange: this.queryField,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 209,\n        columnNumber: 25\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"video-grid\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 211,\n        columnNumber: 17\n      }\n    }, renderTributes), /*#__PURE__*/React.createElement(\"div\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 22\n      }\n    }), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 214,\n        columnNumber: 27\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"clear\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 215,\n        columnNumber: 17\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"post-tribute-card\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 216,\n        columnNumber: 17\n      }\n    }, /*#__PURE__*/React.createElement(\"h4\", {\n      className: \"text-blue\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 17\n      }\n    }, \"Upload Video \", /*#__PURE__*/React.createElement(\"img\", {\n      src: Pen2,\n      className: \"pen\",\n      alt: \"\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 56\n      }\n    })), /*#__PURE__*/React.createElement(\"br\", {\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 217,\n        columnNumber: 101\n      }\n    }), /*#__PURE__*/React.createElement(\"div\", {\n      className: \"post-tribute-section\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 218,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      className: \"story-entry-form\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 219,\n        columnNumber: 25\n      }\n    }, /*#__PURE__*/React.createElement(\"form\", {\n      onSubmit: this.handleTributePost,\n      method: \"post\",\n      id: \"upload-form\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 220,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 221,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      ref: input => this.photoUpload = input,\n      onChange: this.onChange,\n      name: \"photo\",\n      type: \"file\",\n      accept: \"video/*\",\n      class: \"form-control image-input\",\n      id: \"video-input\",\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 222,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 224,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      ref: input => _name = input,\n      name: \"name\",\n      placeholder: \"Please enter your name\",\n      type: \"text\",\n      class: \"form-control\",\n      id: \"name-input\",\n      required: true,\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 225,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(\"div\", {\n      class: \"form-group\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 227,\n        columnNumber: 29\n      }\n    }, /*#__PURE__*/React.createElement(\"input\", {\n      ref: input => _tags = input,\n      name: \"tags\",\n      placeholder: \"Tag friends and family, separate with comma\",\n      type: \"text\",\n      class: \"form-control\",\n      id: \"tag-input\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 228,\n        columnNumber: 33\n      }\n    })), /*#__PURE__*/React.createElement(\"button\", {\n      type: \"submit\",\n      id: \"upload-button\",\n      class: \"btn btn-primary float-right\",\n      __self: this,\n      __source: {\n        fileName: _jsxFileName,\n        lineNumber: 230,\n        columnNumber: 29\n      }\n    }, \"Upload Video(Max. 10MB)\"))))))));\n  }\n\n}","map":{"version":3,"sources":["/Users/hipheckt/codes/evestng/react/src/Videos.js"],"names":["React","Component","axios","Link","swal","$","Header","Pen","Pen2","_name","_tags","Galleri","constructor","props","queryField","e","preventDefault","setState","query","target","value","get","defaults","baseURL","state","then","response","console","log","json","data","success","tributes","alert","catch","error","fetchTributes","handleTributePost","attr","html","formData","FormData","append","file","method","url","headers","id","name","video","tags","tribute","tributeData","timestamp","Date","toString","appState","localStorage","JSON","stringify","message","button","timer","val","removeAttr","uploadVideo","photoUpload","click","onChange","event","imageSource","imageData","files","reader","FileReader","readAsDataURL","onload","result","currentPage","tributesPerPage","bind","componentDidMount","render","tributesList","indexOfLastTribute","indexOfFirstTribute","currentTributes","slice","renderTributes","map","index","input"],"mappings":"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","sourcesContent":["import React, { Component } from 'react'\nimport axios from \"axios\";\nimport { Link } from \"react-router-dom\";\n// import Sound from 'react-sound';\nimport swal from 'sweetalert';\nimport $ from \"jquery\";\n\nimport Header from './common/Header'\n\nimport Pen from \"./assets/images/icons/gallery.png\";\nimport Pen2 from \"./assets/images/icons/video.png\";\n\nvar _name, _tags;\n\n\nexport default class Galleri extends Component {\n    constructor(props) {\n        super(props);\n        // let { user } = this.props.appstate;\n        this.state = {\n          file: null,\n          tributes: [],\n          currentPage: 1,\n          tributesPerPage: 50,\n          query: \"\"\n        };\n        this.onChange = this.onChange.bind(this);\n      }\n\n      queryField = e => {\n        e.preventDefault();\n        this.setState({\n          query: e.target.value\n        });\n        axios\n          .get(`${axios.defaults.baseURL}/photos/${this.state.query}`)\n          .then(response => {\n            console.log(response);\n            return response;\n          })\n          .then(json => {\n            if (json.data.success) {\n              this.setState({ tributes: json.data.tributes });\n            } else alert(\"Fetching Photos Failed!\");\n          })\n          .catch(error => {\n            console.error(`An Error Occured! ${error}`);\n          });\n      }\n\n      componentDidMount() {\n        this.fetchTributes();\n      }\n      \n      fetchTributes = e => {\n        axios\n          .get(`${axios.defaults.baseURL}/videos`)\n          .then(response => {\n            console.log(response);\n            return response;\n          })\n          .then(json => {\n            if (json.data.success) {\n              this.setState({ tributes: json.data.tributes });\n            } else alert(\"Fetching Tributes Failed!\");\n          })\n          .catch(error => {\n            console.error(`An Error Occured! ${error}`);\n          });\n      }\n    \n      handleTributePost = e => {\n        e.preventDefault();\n\n        $(\"#upload-button\")\n        .attr(\"disabled\", \"disabled\")\n        .html(\"Uploading Video...\");\n    \n        var formData = new FormData();\n        formData.append(\"name\", _name.value);\n        formData.append(\"video\", this.state.file);\n        formData.append(\"tags\", _tags.value);\n    \n        console.log(formData);\n    \n      axios({\n          method: 'post',\n          url: `${axios.defaults.baseURL}/video`,\n          data: formData,\n            headers: {'Content-Type': 'multipart/form-data' }\n            })\n        .then(response => {\n          console.log(response);\n          return response;\n        })\n        .then(json => {\n          const { id, name, video, tags } = json.data.tribute;\n          let tributeData = {\n            id,\n            name,\n            video,\n            tags,\n            timestamp: new Date().toString()\n          };\n          let appState = {\n            tribute: tributeData\n          };\n          // save app state with user date in local storage\n          localStorage[\"appState\"] = JSON.stringify(appState);\n          this.setState({\n            tribute: appState.tribute,\n          });\n    \n          if (json.data.success === true) {\n            swal(\"Published!\", \"\" + json.data.message, \"success\", {\n              button: false,\n              timer: 1500\n            });\n            $(\"#name-input\").val('');\n            $(\"#video-input\").val('');\n            $(\"#tag-input\").val('');\n            this.fetchTributes();\n            // redirect home\n            // this.props.history.push(\"/dashboard\");\n          } else {\n            // alert(json.data.message);\n            swal(\"Alert!\", \"\" + json.data.message, \"warning\", {\n              button: false,\n              timer: 1500\n            });\n            $(\"#upload-button\")\n              .removeAttr(\"disabled\")\n              .html(\"Upload Video(Max. 10MB)\");\n          }\n          \n        })\n        .catch(error => {\n          // alert(\"An Error Occured!\" + error);\n          console.log(error.response.data);\n          swal(\"Warning!\", \"Select Video to Upload\", \"warning\", {\n            button: false,\n            timer: 1500\n          });\n          $(\"#upload-button\")\n              .removeAttr(\"disabled\")\n              .html(\"Upload Video(Max. 10MB)\");\n        });\n      };\n\n    uploadVideo = e => {\n    this.photoUpload.click();\n    };\n\n    onChange = event => {\n    this.setState({ imageSource: '', imageData: '', file:event.target.files[0] });\n    const file = event.target.files[0];\n    console.log(file);\n\n    if (file) {\n        let reader = new FileReader();\n        reader.readAsDataURL(event.target.files[0]);\n        reader.onload = event => {\n        this.setState({\n            imageSource: event.target.result,\n            imageData: file\n        });\n        };\n    }\n    };\n    \n    render() {\n        const { currentPage, tributesPerPage } = this.state;\n\n        const tributesList = this.state.tributes;\n        const indexOfLastTribute = currentPage * tributesPerPage;\n        const indexOfFirstTribute = indexOfLastTribute - tributesPerPage;\n        const currentTributes = tributesList.slice(indexOfFirstTribute, indexOfLastTribute);\n        \n        const renderTributes = currentTributes.map((tribute, index) => {\n            return (\n                <div className=\"gallery-videos\">\n                    <video src={tribute.video} controls></video>\n                </div>\n            );\n        });\n        \n    // const { currentPage, tributesPerPage } = this.state;\n\n    // Logic for displaying tributes\n    // const tributesList = this.state.tributes;\n    // const indexOfLastTribute = currentPage * tributesPerPage;\n    // const indexOfFirstTribute = indexOfLastTribute - tributesPerPage;\n    // const currentTributes = tributesList.slice(indexOfFirstTribute, indexOfLastTribute);\n\n    // const renderTributes = currentTributes.map((tribute, index) => {\n    // return (\n    //         <img src={tribute.photo} key={tribute.id} className=\"gallery-image\" alt=\"\"/>\n    // );\n    // });\n        return (\n            <div>\n                <Header/>\n                <div className=\"center-canvas\">\n                <div className=\"gallery-menu\"><br/>\n                    <Link to=\"gallery\" className=\"gallery-menu-item\"><h4>Photos <img src={Pen} className=\"pen\" alt=\"\"/></h4></Link>\n                    <Link to=\"videos\" className=\"gallery-menu-item\"><h4>Videos <img src={Pen2} className=\"pen\" alt=\"\"/></h4></Link>\n                </div>\n                <div className=\"query-field\">\n                Filter: <input name=\"query\" className=\"query-input\" placeholder=\" search videos by name or tags...\" onChange={this.queryField}/>\n                </div>\n                <div className=\"video-grid\">\n                    {renderTributes}\n                </div>\n                <div><br/><br/>\n                <div className=\"clear\"></div>\n                <div className=\"post-tribute-card\">\n                <h4 className=\"text-blue\">Upload Video <img src={Pen2} className=\"pen\" alt=\"\"/></h4><br/>\n                        <div className=\"post-tribute-section\">\n                        <div className=\"story-entry-form\">\n                            <form onSubmit={this.handleTributePost} method=\"post\" id=\"upload-form\">\n                            <div class=\"form-group\">\n                                <input ref={input => (this.photoUpload = input)} onChange= {this.onChange} name=\"photo\" type=\"file\" accept=\"video/*\" class=\"form-control image-input\" id=\"video-input\" required/>\n                            </div>\n                            <div class=\"form-group\">\n                                <input ref={input => (_name = input)} name=\"name\"  placeholder=\"Please enter your name\" type=\"text\" class=\"form-control\" id=\"name-input\" required/>\n                            </div>\n                            <div class=\"form-group\">\n                                <input ref={input => (_tags = input)} name=\"tags\"  placeholder=\"Tag friends and family, separate with comma\" type=\"text\" class=\"form-control\" id=\"tag-input\"/>\n                            </div>\n                            <button type=\"submit\" id=\"upload-button\" class=\"btn btn-primary float-right\">Upload Video(Max. 10MB)</button>\n                            </form>\n                        </div>\n                        </div>\n                    </div>\n                </div>\n                </div>\n            </div>\n        )\n    }\n}\n"]},"metadata":{},"sourceType":"module"}