{"ast":null,"code":"import _classCallCheck from\"/Users/hipheckt/codes/niyiogunwuyi/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/hipheckt/codes/niyiogunwuyi/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/hipheckt/codes/niyiogunwuyi/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/hipheckt/codes/niyiogunwuyi/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import axios from\"axios\";// import { Link } from \"react-router-dom\";\n// import Sound from 'react-sound';\nimport swal from'sweetalert';import $ from\"jquery\";import Header from\"./common/Header.js\";import Pen from\"./assets/images/icons/pen.png\";import{Link}from\"react-router-dom\";var _name,_tags,_tribute;var Story=/*#__PURE__*/function(_React$Component){_inherits(Story,_React$Component);var _super=_createSuper(Story);function Story(props){var _this;_classCallCheck(this,Story);_this=_super.call(this,props);// let { user } = this.props.appstate;\n_this.queryField=function(e){e.preventDefault();_this.setState({query:e.target.value});axios.get(\"\".concat(axios.defaults.baseURL,\"/stories/\").concat(_this.state.query)).then(function(response){console.log(response);return response;}).then(function(json){if(json.data.success){_this.setState({tributes:json.data.tributes});}else alert(\"Fetching Tributes Failed!\");}).catch(function(error){console.error(\"An Error Occured! \".concat(error));});};_this.fetchTributes=function(e){axios.get(\"\".concat(axios.defaults.baseURL,\"/stories\")).then(function(response){console.log(response);return response;}).then(function(json){if(json.data.success){_this.setState({tributes:json.data.tributes});}else alert(\"Fetching Tributes Failed!\");}).catch(function(error){console.error(\"An Error Occured! \".concat(error));});};_this.handleTributePost=function(e){e.preventDefault();var formData=new FormData();formData.append(\"name\",_name.value);formData.append(\"tags\",_tags.value);formData.append(\"story\",_tribute.value);console.log(formData);axios({method:'post',url:\"\".concat(axios.defaults.baseURL,\"/story\"),data:formData}).then(function(response){console.log(response);return response;}).then(function(json){var _json$data$tribute=json.data.tribute,id=_json$data$tribute.id,name=_json$data$tribute.name,tags=_json$data$tribute.tags,tribute=_json$data$tribute.tribute;var tributeData={id:id,name:name,tags:tags,tribute:tribute,timestamp:new Date().toString()};var appState={tribute:tributeData};// save app state with user date in local storage\nlocalStorage[\"appState\"]=JSON.stringify(appState);_this.setState({tribute:appState.tribute});if(json.data.success===true){swal(\"Published!\",\"\"+json.data.message,\"success\",{button:false,timer:1500});$(\"#name-input\").val('');$(\"#tribute-input\").val('');$(\"#tag-input\").val('');_this.fetchTributes();// redirect home\n// this.props.history.push(\"/dashboard\");\n}else{// alert(json.data.message);\nswal(\"Alert!\",\"\"+json.data.message,\"warning\");}}).catch(function(error){// alert(\"An Error Occured!\" + error);\nconsole.log(error.response.data);swal(\"Warning!\",\"\"+error.response.data.message.tribute,\"warning\");});};_this.state={tributes:[],currentPage:1,tributesPerPage:20,query:\"\"};return _this;}_createClass(Story,[{key:\"handleClick\",value:function handleClick(event){event.preventDefault();this.setState({currentPage:Number(event.target.id)});$(\"#\"+\"\".concat(event.target.id)).attr('class','pg-link active-link');}},{key:\"componentDidMount\",value:function componentDidMount(){this.fetchTributes();}},{key:\"render\",value:function render(){var _this2=this;var _this$state=this.state,tributes=_this$state.tributes,currentPage=_this$state.currentPage,tributesPerPage=_this$state.tributesPerPage;// Logic for displaying tributes\nvar tributesList=this.state.tributes;var indexOfLastTribute=currentPage*tributesPerPage;var indexOfFirstTribute=indexOfLastTribute-tributesPerPage;var currentTributes=tributesList.slice(indexOfFirstTribute,indexOfLastTribute);var renderTributes=currentTributes.map(function(tribute,index){return/*#__PURE__*/React.createElement(\"div\",{className:\"v-card\",key:tribute.id},/*#__PURE__*/React.createElement(\"div\",{className:\"tribute-card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"post-content\"},/*#__PURE__*/React.createElement(\"p\",{className:\"poster-name\"},\"Posted by \",tribute.name,\" on \",tribute.date),/*#__PURE__*/React.createElement(\"p\",{className:\"post\"},tribute.story),/*#__PURE__*/React.createElement(\"p\",{className:\"tags float-right\"},/*#__PURE__*/React.createElement(\"b\",null,\"Tagged in this Story:\"),\" \",tribute.tags))));});// Logic for displaying page numbers\nvar pageNumbers=[];for(var i=1;i<=Math.ceil(tributes.length/tributesPerPage);i++){pageNumbers.push(i);}var renderPageNumbers=pageNumbers.map(function(number){return/*#__PURE__*/React.createElement(\"li\",{className:\"pg-link\",key:number,id:number,onClick:_this2.handleClick},number);});return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(\"div\",{className:\"center-canvas\"},/*#__PURE__*/React.createElement(\"div\",{className:\"center-content\"},/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"h4\",null,\"Stories \",/*#__PURE__*/React.createElement(\"img\",{src:Pen,className:\"pen\",alt:\"\"}))),/*#__PURE__*/React.createElement(\"div\",{className:\"query-field\"},\"Filter: \",/*#__PURE__*/React.createElement(\"input\",{name:\"query\",className:\"query-input\",placeholder:\" search stories by name or tags...\",onChange:this.queryField})),renderTributes,/*#__PURE__*/React.createElement(\"div\",{className:\"post-tribute-card\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"text-blue\"},\"Write a Story \",/*#__PURE__*/React.createElement(\"img\",{src:Pen,className:\"pen\",alt:\"\"})),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"post-tribute-section\"},/*#__PURE__*/React.createElement(\"div\",{className:\"story-entry-form\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleTributePost,method:\"post\"},/*#__PURE__*/React.createElement(\"div\",{class:\"form-group\"},/*#__PURE__*/React.createElement(\"textarea\",{ref:function ref(input){return _tribute=input;},placeholder:\"Write your story here...\",name:\"tribute\",type:\"text\",class:\"form-control\",maxlength:\"25000\",cols:\"20\",rows:\"10\",id:\"tribute-input\",required:true})),/*#__PURE__*/React.createElement(\"div\",{class:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{ref:function ref(input){return _name=input;},name:\"name\",placeholder:\"Please enter your name\",type:\"text\",class:\"form-control\",id:\"name-input\",required:true})),/*#__PURE__*/React.createElement(\"div\",{class:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{ref:function ref(input){return _tags=input;},name:\"tags\",placeholder:\"Tag friends and family, separate with comma\",type:\"text\",class:\"form-control\",id:\"tag-input\",required:true})),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",class:\"btn btn-primary float-right\"},\"Publish Story\")))),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null))));}}]);return Story;}(React.Component);// module.exports = Tribute;\nexport default Story;","map":{"version":3,"sources":["/Users/hipheckt/codes/niyiogunwuyi/react/src/Stories.js"],"names":["React","axios","swal","$","Header","Pen","Link","_name","_tags","_tribute","Story","props","queryField","e","preventDefault","setState","query","target","value","get","defaults","baseURL","state","then","response","console","log","json","data","success","tributes","alert","catch","error","fetchTributes","handleTributePost","formData","FormData","append","method","url","tribute","id","name","tags","tributeData","timestamp","Date","toString","appState","localStorage","JSON","stringify","message","button","timer","val","currentPage","tributesPerPage","event","Number","attr","tributesList","indexOfLastTribute","indexOfFirstTribute","currentTributes","slice","renderTributes","map","index","date","story","pageNumbers","i","Math","ceil","length","push","renderPageNumbers","number","handleClick","input","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\n// import { Link } from \"react-router-dom\";\n// import Sound from 'react-sound';\nimport swal from 'sweetalert';\nimport $ from \"jquery\";\n\nimport Header from \"./common/Header.js\";\nimport Pen from \"./assets/images/icons/pen.png\";\nimport { Link } from \"react-router-dom\";\n\nvar _name, _tags, _tribute;\n\nclass Story extends React.Component {\n  constructor(props) {\n    super(props);\n    // let { user } = this.props.appstate;\n    this.state = {\n      tributes: [],\n      currentPage: 1,\n      tributesPerPage: 20,\n      query: \"\"\n    };\n  }\n\n  queryField = e => {\n    e.preventDefault();\n    this.setState({\n      query: e.target.value\n    });\n    axios\n      .get(`${axios.defaults.baseURL}/stories/${this.state.query}`)\n      .then(response => {\n        console.log(response);\n        return response;\n      })\n      .then(json => {\n        if (json.data.success) {\n          this.setState({ tributes: json.data.tributes });\n        } else alert(\"Fetching Tributes Failed!\");\n      })\n      .catch(error => {\n        console.error(`An Error Occured! ${error}`);\n      });\n  }\n\n  handleClick(event) {\n    event.preventDefault();\n    this.setState({\n      currentPage: Number(event.target.id)\n    });\n    $(\"#\"+`${event.target.id}`).attr('class', 'pg-link active-link');\n  }\n\n\n  componentDidMount() {\n    this.fetchTributes();\n  }\n\n\n  fetchTributes = e => {\n    axios\n      .get(`${axios.defaults.baseURL}/stories`)\n      .then(response => {\n        console.log(response);\n        return response;\n      })\n      .then(json => {\n        if (json.data.success) {\n          this.setState({ tributes: json.data.tributes });\n        } else alert(\"Fetching Tributes Failed!\");\n      })\n      .catch(error => {\n        console.error(`An Error Occured! ${error}`);\n      });\n  }\n\n  handleTributePost = e => {\n    e.preventDefault();\n\n    var formData = new FormData();\n    formData.append(\"name\", _name.value);\n    formData.append(\"tags\", _tags.value);\n    formData.append(\"story\", _tribute.value);\n\n    console.log(formData);\n\n  axios({\n      method: 'post',\n      url: `${axios.defaults.baseURL}/story`,\n      data: formData\n      })\n    .then(response => {\n      console.log(response);\n      return response;\n    })\n    .then(json => {\n      const { id, name, tags, tribute } = json.data.tribute;\n      let tributeData = {\n        id,\n        name,\n        tags,\n        tribute,\n        timestamp: new Date().toString()\n      };\n      let appState = {\n        tribute: tributeData\n      };\n      // save app state with user date in local storage\n      localStorage[\"appState\"] = JSON.stringify(appState);\n      this.setState({\n        tribute: appState.tribute,\n      });\n\n      if (json.data.success === true) {\n        swal(\"Published!\", \"\" + json.data.message, \"success\", {\n          button: false,\n          timer: 1500\n        });\n        $(\"#name-input\").val('');\n        $(\"#tribute-input\").val('');\n        $(\"#tag-input\").val('');\n        this.fetchTributes();\n        // redirect home\n        // this.props.history.push(\"/dashboard\");\n      } else {\n        // alert(json.data.message);\n        swal(\"Alert!\", \"\" + json.data.message, \"warning\");\n      }\n\n    })\n    .catch(error => {\n      // alert(\"An Error Occured!\" + error);\n      console.log(error.response.data);\n      swal(\"Warning!\", \"\" + error.response.data.message.tribute, \"warning\");\n    });\n\n  };\n\n\n  render() {\n\n    const { tributes, currentPage, tributesPerPage } = this.state;\n\n    // Logic for displaying tributes\n    const tributesList = this.state.tributes;\n    const indexOfLastTribute = currentPage * tributesPerPage;\n    const indexOfFirstTribute = indexOfLastTribute - tributesPerPage;\n    const currentTributes = tributesList.slice(indexOfFirstTribute, indexOfLastTribute);\n\n    const renderTributes = currentTributes.map((tribute, index) => {\n      return (\n          <div className=\"v-card\" key={tribute.id}>\n            <div className=\"tribute-card\">\n            <div className=\"post-content\">\n                  <p className=\"poster-name\">Posted by {tribute.name} on {tribute.date}</p>\n                  <p className=\"post\">{tribute.story}</p>\n                  <p className=\"tags float-right\"><b>Tagged in this Story:</b> {tribute.tags}</p>\n                  </div>\n            </div>\n          </div>\n      );\n    });\n\n    // Logic for displaying page numbers\n    const pageNumbers = [];\n    for (let i = 1; i <= Math.ceil(tributes.length / tributesPerPage); i++) {\n      pageNumbers.push(i);\n    }\n\n    const renderPageNumbers = pageNumbers.map(number => {\n      return (\n        <li\n          className=\"pg-link\"\n          key={number}\n          id={number}\n          onClick={this.handleClick}\n        >\n          {number}\n        </li>\n      );\n    });\n\n\n    return (\n      <div>\n        <Header/>\n        \n        <div className=\"center-canvas\">\n          <div className=\"center-content\"><br/>\n            <h4>Stories <img src={Pen} className=\"pen\" alt=\"\"/></h4>\n          </div>\n            <div className=\"query-field\">\n              Filter: <input name=\"query\" className=\"query-input\" placeholder=\" search stories by name or tags...\" onChange={this.queryField}/>\n            </div>\n            {renderTributes}\n            <div className=\"post-tribute-card\">\n                <h4 className=\"text-blue\">Write a Story <img src={Pen} className=\"pen\" alt=\"\"/></h4><br/>\n                <div className=\"post-tribute-section\">\n                  <div className=\"story-entry-form\">\n                    <form onSubmit={this.handleTributePost} method=\"post\">\n                      <div class=\"form-group\">\n                        <textarea  ref={input => (_tribute = input)}  placeholder=\"Write your story here...\" name=\"tribute\" type=\"text\" class=\"form-control\" maxlength=\"25000\" cols=\"20\" rows=\"10\" id=\"tribute-input\" required/>\n                      </div>\n                      <div class=\"form-group\">\n                        <input ref={input => (_name = input)} name=\"name\"  placeholder=\"Please enter your name\" type=\"text\" class=\"form-control\" id=\"name-input\" required/>\n                      </div>\n                      <div class=\"form-group\">\n                        <input ref={input => (_tags = input)} name=\"tags\"  placeholder=\"Tag friends and family, separate with comma\" type=\"text\" class=\"form-control\" id=\"tag-input\" required/>\n                      </div>\n                      <button type=\"submit\" class=\"btn btn-primary float-right\">Publish Story</button>\n                    </form>\n                  </div>\n                </div>\n                <br/>\n                <br/>\n              </div>\n        </div>\n      </div>\n    );\n  }\n}\n// module.exports = Tribute;\n\nexport default Story;\n"]},"metadata":{},"sourceType":"module"}