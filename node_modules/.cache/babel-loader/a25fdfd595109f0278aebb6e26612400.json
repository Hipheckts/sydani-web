{"ast":null,"code":"import _classCallCheck from\"/Users/hipheckt/codes/sydani-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/hipheckt/codes/sydani-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _assertThisInitialized from\"/Users/hipheckt/codes/sydani-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/assertThisInitialized\";import _inherits from\"/Users/hipheckt/codes/sydani-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/hipheckt/codes/sydani-web/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import axios from\"axios\";import{Link}from\"react-router-dom\";import $ from\"jquery\";import swal from'sweetalert';var styles={input:{backgroundColor:\"white\",border:\"1px solid #cccccc\",padding:15,float:\"left\",clear:\"right\",width:\"80%\",margin:15},button:{height:44,boxShadow:\"0px 8px 15px rgba(0, 0, 0, 0.1)\",border:\"none\",backgroundColor:\"red\",margin:15,float:\"left\",clear:\"both\",width:\"85%\",color:\"white\",padding:15},link:{width:\"100%\",float:\"left\",clear:\"both\",textAlign:\"center\"}};var _fname,_lname,_email,_phone,_password;var id=window.location.href.split('/')[window.location.href.split('/').length-1];var Edit=/*#__PURE__*/function(_React$Component){_inherits(Edit,_React$Component);var _super=_createSuper(Edit);function Edit(props){var _this;_classCallCheck(this,Edit);_this=_super.call(this,props);// let { user } = this.props.appstate;\n_this.handleLogin=function(e){e.preventDefault();$(\"#email-login-btn\").attr(\"disabled\",\"disabled\").html('<i class=\"fa fa-spinner fa-spin fa-1x fa-fw\"></i><span class=\"sr-only\">Loading...</span>');var formData=new FormData();formData.append(\"fname\",_fname.value);formData.append(\"lname\",_lname.value);formData.append(\"email\",_email.value);formData.append(\"phone\",_phone.value);formData.append(\"avatar\",_this.state.file);formData.append(\"password\",_password.value);console.log(formData);axios({method:'post',url:\"http://localhost:8000/api/v1/user/\".concat(id),data:formData,headers:{'Authorization':\"Bearer \".concat(_this.state.token),'Content-Type':'multipart/form-data'}}).then(function(response){console.log(response);return response;}).then(function(json){var _json$data$user=json.data.user,id=_json$data$user.id,fname=_json$data$user.fname,lname=_json$data$user.lname,email=_json$data$user.email,phone=_json$data$user.phone;var token=json.data.token.token;var userData={id:id,fname:fname,lname:lname,email:email,phone:phone,token:token,timestamp:new Date().toString()};var appState={isLoggedIn:true,user:userData};// save app state with user date in local storage\nlocalStorage[\"appState\"]=JSON.stringify(appState);_this.setState({isLoggedIn:appState.isLoggedIn,user:appState.user,token:appState.token});if(json.data.success===true){swal(\"Updated!\",\"\"+json.data.message,\"success\");// redirect home\n_this.props.history.push(\"/\");}else{// alert(json.data.message);\nswal(\"Alert!\",\"\"+json.data.message,\"warning\");$(\"#email-login-btn\").removeAttr(\"disabled\").html(\"Update\");}}).catch(function(error){// alert(\"An Error Occured!\" + error);\nconsole.log(error.response.data);if(error.response.data.message.fname===\"\"){swal(\"Warning!\",\"\"+error.response.data.message.fname,\"warning\");}else{swal(\"Warning!\",\"Please fill all fields\",\"warning\");}$(\"#email-login-btn\").removeAttr(\"disabled\").html(\"Update\");});};_this.uploadPhoto=function(e){_this.photoUpload.click();};_this.onChange=function(event){_this.setState({imageSource:'',imageData:'',file:event.target.files[0]});var file=event.target.files[0];console.log(file);if(file){var reader=new FileReader();reader.readAsDataURL(event.target.files[0]);reader.onload=function(event){_this.setState({imageSource:event.target.result,imageData:file});};}};_this.state={token:localStorage[\"appState\"]?JSON.parse(localStorage[\"appState\"]).user.token:\"\",user:[],imageSource:'',file:null};_this.onChange=_this.onChange.bind(_assertThisInitialized(_this));return _this;}_createClass(Edit,[{key:\"componentDidMount\",value:function componentDidMount(){var _this2=this;// console.log(id);\nvar id=window.location.href.split('/')[window.location.href.split('/').length-1];axios.get(\"http://localhost:8000/api/v1/user/\".concat(id),{headers:{'Authorization':\"Bearer \".concat(this.state.token)}}).then(function(response){console.log(response);return response;}).then(function(json){if(json.data.success){_this2.setState({user:json.data.user[0]});// } else alert(\"Cannot Fetch Data!\");\n}else swal(\"Oops!\",\"Cannot Fetch Data!\",\"error\");;}).catch(function(error){console.error(\"An Error Occured! \".concat(error));});// alert(id)\n}},{key:\"render\",value:function render(){var _this3=this;$(\"#fname-input\").attr(\"value\",this.state.user.fname);$(\"#lname-input\").attr(\"value\",this.state.user.lname);$(\"#email-input\").attr(\"value\",this.state.user.email);$(\"#phone-input\").attr(\"value\",this.state.user.phone);$(\"#avatar-input\").attr(\"value\",this.state.user.password);return/*#__PURE__*/React.createElement(\"div\",{style:styles},/*#__PURE__*/React.createElement(\"h3\",{style:{padding:15}},\"Edit User\"),/*#__PURE__*/React.createElement(\"form\",{id:\"login-form\",action:\"\",onSubmit:this.handleLogin,method:\"post\"},/*#__PURE__*/React.createElement(\"input\",{ref:function ref(input){return _fname=input;},style:styles.input,autoComplete:\"off\",id:\"fname-input\",name:\"fname\",type:\"text\",className:\"center-block\"// placeholder={this.state.user.fname}\n}),/*#__PURE__*/React.createElement(\"input\",{ref:function ref(input){return _lname=input;},style:styles.input,autoComplete:\"off\",id:\"lname-input\",name:\"lname\",type:\"text\",className:\"center-block\",placeholder:this.state.user.lname}),/*#__PURE__*/React.createElement(\"input\",{ref:function ref(input){return _email=input;},style:styles.input,autoComplete:\"off\",id:\"email-input\",name:\"email\",type:\"text\",placeholder:this.state.user.email}),/*#__PURE__*/React.createElement(\"input\",{ref:function ref(input){return _phone=input;},style:styles.input,autoComplete:\"off\",id:\"phone-input\",name:\"phone\",type:\"text\",className:\"center-block\",placeholder:this.state.user.phone}),/*#__PURE__*/React.createElement(\"div\",{onClick:this.uploadPhoto,className:\"uk-inline\"},/*#__PURE__*/React.createElement(\"img\",{className:\"\",src:this.state.imageSource?this.state.imageSource:this.state.user.avatar?this.state.user.avatar:null,alt:\"Alt\"})),/*#__PURE__*/React.createElement(\"input\",{ref:function ref(input){return _this3.photoUpload=input;},onChange:this.onChange,style:styles.input,autoComplete:\"off\",id:\"avatar-input\",name:\"avatar\",type:\"file\",className:\"center-block\"}),/*#__PURE__*/React.createElement(\"input\",{ref:function ref(input){return _password=input;},style:styles.input,autoComplete:\"off\",id:\"password-input\",name:\"password\",type:\"password\",className:\"center-block\",placeholder:\"Enter new password or leave blank to maintain old password\"}),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",style:styles.button,className:\"landing-page-btn center-block text-center\",id:\"email-login-btn\",href:\"#facebook\"},\"Update\"),/*#__PURE__*/React.createElement(Link,{style:styles.link,to:\"/\"},\"Home\")));}}]);return Edit;}(React.Component);export default Edit;","map":{"version":3,"sources":["/Users/hipheckt/codes/sydani-web/src/Edit.js"],"names":["React","axios","Link","$","swal","styles","input","backgroundColor","border","padding","float","clear","width","margin","button","height","boxShadow","color","link","textAlign","_fname","_lname","_email","_phone","_password","id","window","location","href","split","length","Edit","props","handleLogin","e","preventDefault","attr","html","formData","FormData","append","value","state","file","console","log","method","url","data","headers","token","then","response","json","user","fname","lname","email","phone","userData","timestamp","Date","toString","appState","isLoggedIn","localStorage","JSON","stringify","setState","success","message","history","push","removeAttr","catch","error","uploadPhoto","photoUpload","click","onChange","event","imageSource","imageData","target","files","reader","FileReader","readAsDataURL","onload","result","parse","bind","get","password","avatar","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\r\nimport axios from \"axios\";\r\nimport { Link } from \"react-router-dom\";\r\nimport $ from \"jquery\";\r\n\r\nimport swal from 'sweetalert';\r\n\r\nconst styles = {\r\n  input: {\r\n    backgroundColor: \"white\",\r\n    border: \"1px solid #cccccc\",\r\n    padding: 15,\r\n    float: \"left\",\r\n    clear: \"right\",\r\n    width: \"80%\",\r\n    margin: 15\r\n  },\r\n  button: {\r\n    height: 44,\r\n    boxShadow: \"0px 8px 15px rgba(0, 0, 0, 0.1)\",\r\n    border: \"none\",\r\n    backgroundColor: \"red\",\r\n    margin: 15,\r\n    float: \"left\",\r\n    clear: \"both\",\r\n    width: \"85%\",\r\n    color: \"white\",\r\n    padding: 15\r\n  },\r\n  link: {\r\n    width: \"100%\",\r\n    float: \"left\",\r\n    clear: \"both\",\r\n    textAlign: \"center\"\r\n  }\r\n};\r\n\r\nvar _fname, _lname, _email, _phone, _password;\r\n\r\nvar id = window.location.href.split('/')[window.location.href.split('/').length - 1];\r\n\r\n\r\nclass Edit extends React.Component{\r\n  constructor(props) {\r\n    super(props);\r\n    // let { user } = this.props.appstate;\r\n    this.state = {\r\n      token: localStorage[\"appState\"]\r\n        ? JSON.parse(localStorage[\"appState\"]).user.token\r\n        : \"\",\r\n      user: [],\r\n      imageSource: '',\r\n      file: null\r\n    };\r\n    this.onChange = this.onChange.bind(this);\r\n  }\r\n\r\n  componentDidMount() {\r\n\r\n    // console.log(id);\r\n    var id = window.location.href.split('/')[window.location.href.split('/').length - 1];\r\n\r\n    axios\r\n      .get(`http://localhost:8000/api/v1/user/${id}`,\r\n      {\r\n        headers: {\r\n          'Authorization': `Bearer ${this.state.token}`\r\n        }\r\n      }\r\n      )\r\n      .then(response => {\r\n        console.log(response);\r\n        return response;\r\n      })\r\n      .then(json => {\r\n        if (json.data.success) {\r\n          this.setState({ user: json.data.user[0] });\r\n        // } else alert(\"Cannot Fetch Data!\");\r\n        } else swal(\"Oops!\", \"Cannot Fetch Data!\", \"error\");;\r\n      })\r\n      .catch(error => {\r\n        console.error(`An Error Occured! ${error}`);\r\n      });\r\n      // alert(id)\r\n\r\n  };\r\n\r\n  handleLogin = e => {\r\n    e.preventDefault();\r\n\r\n    $(\"#email-login-btn\")\r\n    .attr(\"disabled\", \"disabled\")\r\n    .html(\r\n      '<i class=\"fa fa-spinner fa-spin fa-1x fa-fw\"></i><span class=\"sr-only\">Loading...</span>'\r\n    );\r\n\r\n    var formData = new FormData();\r\n    formData.append(\"fname\", _fname.value);\r\n    formData.append(\"lname\", _lname.value);\r\n    formData.append(\"email\", _email.value);\r\n    formData.append(\"phone\", _phone.value);\r\n    formData.append(\"avatar\", this.state.file);\r\n    formData.append(\"password\", _password.value);\r\n\r\n    console.log(formData);\r\n\r\n  axios({\r\n      method: 'post',\r\n      url: `http://localhost:8000/api/v1/user/${id}`,\r\n      data: formData,\r\n      headers: {'Authorization': `Bearer ${this.state.token}`, 'Content-Type': 'multipart/form-data' }\r\n      })\r\n    .then(response => {\r\n      console.log(response);\r\n      return response;\r\n    })\r\n    .then(json => {\r\n      const { id, fname, lname, email, phone } = json.data.user;\r\n      const { token } = json.data.token;\r\n      let userData = {\r\n        id,\r\n        fname,\r\n        lname,\r\n        email,\r\n        phone,\r\n        token,\r\n        timestamp: new Date().toString()\r\n      };\r\n      let appState = {\r\n        isLoggedIn: true,\r\n        user: userData\r\n      };\r\n      // save app state with user date in local storage\r\n      localStorage[\"appState\"] = JSON.stringify(appState);\r\n      this.setState({\r\n        isLoggedIn: appState.isLoggedIn,\r\n        user: appState.user,\r\n        token: appState.token\r\n      });\r\n\r\n      if (json.data.success === true) {\r\n        swal(\"Updated!\", \"\" + json.data.message, \"success\");\r\n        // redirect home\r\n        this.props.history.push(\"/\");\r\n      } else {\r\n        // alert(json.data.message);\r\n        swal(\"Alert!\", \"\" + json.data.message, \"warning\");\r\n        $(\"#email-login-btn\")\r\n          .removeAttr(\"disabled\")\r\n          .html(\"Update\");\r\n      }\r\n\r\n    })\r\n    .catch(error => {\r\n      // alert(\"An Error Occured!\" + error);\r\n      console.log(error.response.data);\r\n      if(error.response.data.message.fname === \"\") {\r\n        swal(\"Warning!\", \"\" + error.response.data.message.fname, \"warning\");\r\n      } else{\r\n        swal(\"Warning!\", \"Please fill all fields\", \"warning\");\r\n      }\r\n      $(\"#email-login-btn\")\r\n        .removeAttr(\"disabled\")\r\n        .html(\"Update\");\r\n    });\r\n\r\n  };\r\n\r\n  // onChange(e) {\r\n  //   this.setState({file:e.target.files[0]});\r\n  // }\r\n\r\n  uploadPhoto = e => {\r\n    this.photoUpload.click();\r\n  };\r\n\r\n  onChange = event => {\r\n    this.setState({ imageSource: '', imageData: '', file:event.target.files[0] });\r\n    const file = event.target.files[0];\r\n    console.log(file);\r\n\r\n    if (file) {\r\n      let reader = new FileReader();\r\n      reader.readAsDataURL(event.target.files[0]);\r\n      reader.onload = event => {\r\n        this.setState({\r\n          imageSource: event.target.result,\r\n          imageData: file\r\n        });\r\n      };\r\n    }\r\n  };\r\n\r\n  render() {\r\n    $(\"#fname-input\")\r\n    .attr(\"value\", this.state.user.fname);\r\n    $(\"#lname-input\")\r\n    .attr(\"value\", this.state.user.lname);\r\n    $(\"#email-input\")\r\n    .attr(\"value\", this.state.user.email);\r\n    $(\"#phone-input\")\r\n    .attr(\"value\", this.state.user.phone);\r\n    $(\"#avatar-input\")\r\n    .attr(\"value\", this.state.user.password);\r\n\r\n    return (\r\n      <div style={styles}>\r\n      <h3 style={{ padding: 15 }}>Edit User</h3>\r\n            <form id=\"login-form\" action=\"\" onSubmit={this.handleLogin} method=\"post\">\r\n            <input\r\n              ref={input => (_fname = input)}\r\n              style={styles.input}\r\n              autoComplete=\"off\"\r\n              id=\"fname-input\"\r\n              name=\"fname\"\r\n              type=\"text\"\r\n              className=\"center-block\"\r\n              // placeholder={this.state.user.fname}\r\n            />\r\n            <input\r\n              ref={input => (_lname = input)}\r\n              style={styles.input}\r\n              autoComplete=\"off\"\r\n              id=\"lname-input\"\r\n              name=\"lname\"\r\n              type=\"text\"\r\n              className=\"center-block\"\r\n              placeholder={this.state.user.lname}\r\n            />\r\n            <input\r\n              ref={input => (_email = input)}\r\n              style={styles.input}\r\n              autoComplete=\"off\"\r\n              id=\"email-input\"\r\n              name=\"email\"\r\n              type=\"text\"\r\n              placeholder={this.state.user.email}\r\n            />\r\n            <input\r\n              ref={input => (_phone = input)}\r\n              style={styles.input}\r\n              autoComplete=\"off\"\r\n              id=\"phone-input\"\r\n              name=\"phone\"\r\n              type=\"text\"\r\n              className=\"center-block\"\r\n              placeholder={this.state.user.phone}\r\n            />\r\n            <div onClick={this.uploadPhoto} className=\"uk-inline\">\r\n                <img\r\n                  className=\"\"\r\n                  src={\r\n                    this.state.imageSource\r\n                      ? this.state.imageSource :\r\n                      this.state.user.avatar ?\r\n                      this.state.user.avatar\r\n                      : null\r\n                  }\r\n                  alt=\"Alt\"\r\n                />\r\n            </div>\r\n            <input\r\n              ref={input => (this.photoUpload = input)}\r\n              onChange= {this.onChange}\r\n              style={styles.input}\r\n              autoComplete=\"off\"\r\n              id=\"avatar-input\"\r\n              name=\"avatar\"\r\n              type=\"file\"\r\n              className=\"center-block\"\r\n            />\r\n            <input\r\n              ref={input => (_password = input)}\r\n              style={styles.input}\r\n              autoComplete=\"off\"\r\n              id=\"password-input\"\r\n              name=\"password\"\r\n              type=\"password\"\r\n              className=\"center-block\"\r\n              placeholder=\"Enter new password or leave blank to maintain old password\"\r\n            />\r\n            <button\r\n              type=\"submit\"\r\n              style={styles.button}\r\n              className=\"landing-page-btn center-block text-center\"\r\n              id=\"email-login-btn\"\r\n              href=\"#facebook\"\r\n            >\r\n              Update\r\n            </button>\r\n            <Link style={styles.link} to=\"/\">\r\n              Home\r\n            </Link>\r\n          </form>\r\n      </div>\r\n    );\r\n  }\r\n}\r\n\r\nexport default Edit;\r\n"]},"metadata":{},"sourceType":"module"}