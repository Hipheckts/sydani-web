{"ast":null,"code":"import _classCallCheck from\"/Users/hipheckt/codes/niyiogunwuyi/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/classCallCheck\";import _createClass from\"/Users/hipheckt/codes/niyiogunwuyi/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createClass\";import _inherits from\"/Users/hipheckt/codes/niyiogunwuyi/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/inherits\";import _createSuper from\"/Users/hipheckt/codes/niyiogunwuyi/react/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/createSuper\";import React from\"react\";import axios from\"axios\";// import { Link } from \"react-router-dom\";\n// import Sound from 'react-sound';\nimport swal from'sweetalert';import $ from\"jquery\";import Header from\"./common/Header.js\";import Pen from\"./assets/images/icons/pen.png\";var _name,_tags,_tribute;var Story=/*#__PURE__*/function(_React$Component){_inherits(Story,_React$Component);var _super=_createSuper(Story);function Story(props){var _this;_classCallCheck(this,Story);_this=_super.call(this,props);// let { user } = this.props.appstate;\n_this.fetchTributes=function(e){axios.get(\"\".concat(axios.defaults.baseURL,\"/stories\")).then(function(response){console.log(response);return response;}).then(function(json){if(json.data.success){_this.setState({tributes:json.data.tributes});}else alert(\"Fetching Tributes Failed!\");}).catch(function(error){console.error(\"An Error Occured! \".concat(error));});};_this.handleTributePost=function(e){e.preventDefault();var formData=new FormData();formData.append(\"name\",_name.value);formData.append(\"tags\",_tags.value);formData.append(\"story\",_tribute.value);console.log(formData);axios({method:'post',url:\"\".concat(axios.defaults.baseURL,\"/story\"),data:formData}).then(function(response){console.log(response);return response;}).then(function(json){var _json$data$tribute=json.data.tribute,id=_json$data$tribute.id,name=_json$data$tribute.name,tags=_json$data$tribute.tags,tribute=_json$data$tribute.tribute;var tributeData={id:id,name:name,tags:tags,tribute:tribute,timestamp:new Date().toString()};var appState={tribute:tributeData};// save app state with user date in local storage\nlocalStorage[\"appState\"]=JSON.stringify(appState);_this.setState({tribute:appState.tribute});if(json.data.success===true){swal(\"Published!\",\"\"+json.data.message,\"success\",{button:false,timer:1500});$(\"#name-input\").val('');$(\"#tribute-input\").val('');$(\"#tag-input\").val('');_this.fetchTributes();// redirect home\n// this.props.history.push(\"/dashboard\");\n}else{// alert(json.data.message);\nswal(\"Alert!\",\"\"+json.data.message,\"warning\");}}).catch(function(error){// alert(\"An Error Occured!\" + error);\nconsole.log(error.response.data);swal(\"Warning!\",\"\"+error.response.data.message.tribute,\"warning\");});};_this.state={tributes:[],currentPage:1,tributesPerPage:10};return _this;}_createClass(Story,[{key:\"componentDidMount\",value:function componentDidMount(){this.fetchTributes();}},{key:\"render\",value:function render(){var _this$state=this.state,currentPage=_this$state.currentPage,tributesPerPage=_this$state.tributesPerPage;// Logic for displaying tributes\nvar tributesList=this.state.tributes;var indexOfLastTribute=currentPage*tributesPerPage;var indexOfFirstTribute=indexOfLastTribute-tributesPerPage;var currentTributes=tributesList.slice(indexOfFirstTribute,indexOfLastTribute);var renderTributes=currentTributes.map(function(tribute,index){return/*#__PURE__*/React.createElement(\"div\",{className:\"v-card\",key:tribute.id},/*#__PURE__*/React.createElement(\"div\",{className:\"tribute-card\"},/*#__PURE__*/React.createElement(\"div\",{className:\"post-content\"},/*#__PURE__*/React.createElement(\"p\",{className:\"poster-name\"},\"Posted by \",tribute.name,\" on \",tribute.date),/*#__PURE__*/React.createElement(\"p\",{className:\"post\"},tribute.story),/*#__PURE__*/React.createElement(\"p\",{className:\"tags float-right\"},/*#__PURE__*/React.createElement(\"b\",null,\"Tagged in this Story:\"),\" \",tribute.tags))));});return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Header,null),/*#__PURE__*/React.createElement(\"div\",{className:\"center-canvas\"},/*#__PURE__*/React.createElement(\"div\",{className:\"post-tribute-card\"},/*#__PURE__*/React.createElement(\"h4\",{className:\"text-white\"},\"Write a Story \",/*#__PURE__*/React.createElement(\"img\",{src:Pen,className:\"pen\",alt:\"\"})),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"div\",{className:\"post-tribute-section\"},/*#__PURE__*/React.createElement(\"div\",{className:\"story-entry-form\"},/*#__PURE__*/React.createElement(\"form\",{onSubmit:this.handleTributePost,method:\"post\"},/*#__PURE__*/React.createElement(\"div\",{class:\"form-group\"},/*#__PURE__*/React.createElement(\"textarea\",{ref:function ref(input){return _tribute=input;},placeholder:\"Write your story here...\",name:\"tribute\",type:\"text\",class:\"form-control\",maxlength:\"25000\",cols:\"20\",rows:\"10\",id:\"tribute-input\"})),/*#__PURE__*/React.createElement(\"div\",{class:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{ref:function ref(input){return _name=input;},name:\"name\",placeholder:\"Please enter your name\",type:\"text\",class:\"form-control\",id:\"name-input\"})),/*#__PURE__*/React.createElement(\"div\",{class:\"form-group\"},/*#__PURE__*/React.createElement(\"input\",{ref:function ref(input){return _tags=input;},name:\"tags\",placeholder:\"Tag friends and family, separate with comma\",type:\"text\",class:\"form-control\",id:\"tag-input\"})),/*#__PURE__*/React.createElement(\"button\",{type:\"submit\",class:\"btn btn-primary float-right\"},\"Publish Story\")))),/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"br\",null)),/*#__PURE__*/React.createElement(\"div\",{className:\"center-content\"},/*#__PURE__*/React.createElement(\"br\",null),/*#__PURE__*/React.createElement(\"h4\",null,\"Stories \",/*#__PURE__*/React.createElement(\"img\",{src:Pen,className:\"pen\",alt:\"\"}))),renderTributes));}}]);return Story;}(React.Component);// module.exports = Tribute;\nexport default Story;","map":{"version":3,"sources":["/Users/hipheckt/codes/niyiogunwuyi/react/src/Stories.js"],"names":["React","axios","swal","$","Header","Pen","_name","_tags","_tribute","Story","props","fetchTributes","e","get","defaults","baseURL","then","response","console","log","json","data","success","setState","tributes","alert","catch","error","handleTributePost","preventDefault","formData","FormData","append","value","method","url","tribute","id","name","tags","tributeData","timestamp","Date","toString","appState","localStorage","JSON","stringify","message","button","timer","val","state","currentPage","tributesPerPage","tributesList","indexOfLastTribute","indexOfFirstTribute","currentTributes","slice","renderTributes","map","index","date","story","input","Component"],"mappings":"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","sourcesContent":["import React from \"react\";\nimport axios from \"axios\";\n// import { Link } from \"react-router-dom\";\n// import Sound from 'react-sound';\nimport swal from 'sweetalert';\nimport $ from \"jquery\";\n\nimport Header from \"./common/Header.js\";\nimport Pen from \"./assets/images/icons/pen.png\";\n\nvar _name, _tags, _tribute;\n\nclass Story extends React.Component {\n  constructor(props) {\n    super(props);\n    // let { user } = this.props.appstate;\n    this.state = {\n      tributes: [],\n      currentPage: 1,\n      tributesPerPage: 10\n    };\n  }\n\n  componentDidMount() {\n    this.fetchTributes();\n  }\n  \n  fetchTributes = e => {\n    axios\n      .get(`${axios.defaults.baseURL}/stories`)\n      .then(response => {\n        console.log(response);\n        return response;\n      })\n      .then(json => {\n        if (json.data.success) {\n          this.setState({ tributes: json.data.tributes });\n        } else alert(\"Fetching Tributes Failed!\");\n      })\n      .catch(error => {\n        console.error(`An Error Occured! ${error}`);\n      });\n  }\n\n  handleTributePost = e => {\n    e.preventDefault();\n\n    var formData = new FormData();\n    formData.append(\"name\", _name.value);\n    formData.append(\"tags\", _tags.value);\n    formData.append(\"story\", _tribute.value);\n\n    console.log(formData);\n\n  axios({\n      method: 'post',\n      url: `${axios.defaults.baseURL}/story`,\n      data: formData\n      })\n    .then(response => {\n      console.log(response);\n      return response;\n    })\n    .then(json => {\n      const { id, name, tags, tribute } = json.data.tribute;\n      let tributeData = {\n        id,\n        name,\n        tags,\n        tribute,\n        timestamp: new Date().toString()\n      };\n      let appState = {\n        tribute: tributeData\n      };\n      // save app state with user date in local storage\n      localStorage[\"appState\"] = JSON.stringify(appState);\n      this.setState({\n        tribute: appState.tribute,\n      });\n\n      if (json.data.success === true) {\n        swal(\"Published!\", \"\" + json.data.message, \"success\", {\n          button: false,\n          timer: 1500\n        });\n        $(\"#name-input\").val('');\n        $(\"#tribute-input\").val('');\n        $(\"#tag-input\").val('');\n        this.fetchTributes();\n        // redirect home\n        // this.props.history.push(\"/dashboard\");\n      } else {\n        // alert(json.data.message);\n        swal(\"Alert!\", \"\" + json.data.message, \"warning\");\n      }\n\n    })\n    .catch(error => {\n      // alert(\"An Error Occured!\" + error);\n      console.log(error.response.data);\n      swal(\"Warning!\", \"\" + error.response.data.message.tribute, \"warning\");\n    });\n\n  };\n\n\n  render() {\n\n    const { currentPage, tributesPerPage } = this.state;\n\n    // Logic for displaying tributes\n    const tributesList = this.state.tributes;\n    const indexOfLastTribute = currentPage * tributesPerPage;\n    const indexOfFirstTribute = indexOfLastTribute - tributesPerPage;\n    const currentTributes = tributesList.slice(indexOfFirstTribute, indexOfLastTribute);\n\n    const renderTributes = currentTributes.map((tribute, index) => {\n      return (\n          <div className=\"v-card\" key={tribute.id}>\n            <div className=\"tribute-card\">\n            <div className=\"post-content\">\n                  <p className=\"poster-name\">Posted by {tribute.name} on {tribute.date}</p>\n                  <p className=\"post\">{tribute.story}</p>\n                  <p className=\"tags float-right\"><b>Tagged in this Story:</b> {tribute.tags}</p>\n                  </div>\n            </div>\n          </div>\n      );\n    });\n\n    return (\n      <div>\n        <Header/>\n        \n        <div className=\"center-canvas\">\n        <div className=\"post-tribute-card\">\n            <h4 className=\"text-white\">Write a Story <img src={Pen} className=\"pen\" alt=\"\"/></h4><br/>\n            <div className=\"post-tribute-section\">\n              <div className=\"story-entry-form\">\n                <form onSubmit={this.handleTributePost} method=\"post\">\n                  <div class=\"form-group\">\n                    <textarea  ref={input => (_tribute = input)}  placeholder=\"Write your story here...\" name=\"tribute\" type=\"text\" class=\"form-control\" maxlength=\"25000\" cols=\"20\" rows=\"10\" id=\"tribute-input\"/>\n                  </div>\n                  <div class=\"form-group\">\n                    <input ref={input => (_name = input)} name=\"name\"  placeholder=\"Please enter your name\" type=\"text\" class=\"form-control\" id=\"name-input\"/>\n                  </div>\n                  <div class=\"form-group\">\n                    <input ref={input => (_tags = input)} name=\"tags\"  placeholder=\"Tag friends and family, separate with comma\" type=\"text\" class=\"form-control\" id=\"tag-input\"/>\n                  </div>\n                  <button type=\"submit\" class=\"btn btn-primary float-right\">Publish Story</button>\n                </form>\n              </div>\n            </div>\n            <br/>\n            <br/>\n          </div>\n          <div className=\"center-content\"><br/>\n            <h4>Stories <img src={Pen} className=\"pen\" alt=\"\"/></h4>\n          </div>\n            {renderTributes}\n        </div>\n      </div>\n    );\n  }\n}\n// module.exports = Tribute;\n\nexport default Story;\n"]},"metadata":{},"sourceType":"module"}